
[Log] Writing console output to: outputFile/gs_32129830065071789.log

==================================================================
OmniGS-R (1.0): GENOMIC SELECTION PIPELINE USING R PACKAGES
==================================================================
Mode: PREDICTION
Enabled models: [RR-BLUP, GBLUP, BRR, BL, BayesA, BayesB, BayesC, RFR, SVR, RKHS, RFC, SVC]
Feature (marker) view: SNP
Results directory: outputFile


Check R libraries required in this pipeline...
âœ“ All required R libraries are available


Generated files:
  YLD -> /isilon/projects/J-002035_flaxgenomics/CZ_project/github_OmniGS_R/finalFile/example/outputFile/pheno_data/YLD_normalized.tsv

[SNP] Performing GS for YLD
[Train] Cleaned VCF : /isilon/projects/J-002035_flaxgenomics/CZ_project/github_OmniGS_R/finalFile/example/outputFile/intermediate_data/train_genotype.aligned.sorted.vcf
[Train] Cleaned Pheno: /isilon/projects/J-002035_flaxgenomics/CZ_project/github_OmniGS_R/finalFile/example/outputFile/intermediate_data/YLD_normalized.aligned.sorted.tsv
[Train] VCF samples in: 298
[Train] Pheno samples in: 293
[Train] Common samples : 293

[STEP]Harmonize train and test vcf file:
[All] Kept common SNPs: 2000
[Train] Train VCF: /isilon/projects/J-002035_flaxgenomics/CZ_project/github_OmniGS_R/finalFile/example/outputFile/intermediate_data/train_genotype.aligned.sorted.harmonized.vcf
[Train] Train VCF samples: 293
[Test] Test  VCF: /isilon/projects/J-002035_flaxgenomics/CZ_project/github_OmniGS_R/finalFile/example/outputFile/intermediate_data/test_genotype.harmonized.vcf
[Test] Test  VCF samples: 186
[All] Combined VCF: /isilon/projects/J-002035_flaxgenomics/CZ_project/github_OmniGS_R/finalFile/example/outputFile/intermediate_data/train_genotype.aligned.sorted__PLUS__test_genotype.combined.harmonized.vcf
Wrote MDS plot to: /isilon/projects/J-002035_flaxgenomics/CZ_project/github_OmniGS_R/finalFile/example/outputFile/plots/combined_mds.png

[STEP]Score genotypes using 0, 1, 2 scheme for SNPs or haplotype markers (HAP)...
Converted vcf file: /isilon/projects/J-002035_flaxgenomics/CZ_project/github_OmniGS_R/finalFile/example/outputFile/intermediate_data/train_genotype.aligned.sorted.harmonized.vcf.GSCode.txt
Converting vcf test_marker_file to 0, 1, 2 NA code for GS...
Converted test vcf file: /isilon/projects/J-002035_flaxgenomics/CZ_project/github_OmniGS_R/finalFile/example/outputFile/intermediate_data/test_genotype.harmonized.vcf.GSCode.txt

[STEP]Perform imputation for SNP or HAP markers...
[PRED] Train imputed: /isilon/projects/J-002035_flaxgenomics/CZ_project/github_OmniGS_R/finalFile/example/outputFile/intermediate_data/train_genotype.aligned.sorted.harmonized.vcf.GSCode.imputed.tsv
[PRED] Test  imputed: /isilon/projects/J-002035_flaxgenomics/CZ_project/github_OmniGS_R/finalFile/example/outputFile/intermediate_data/test_genotype.harmonized.vcf.GSCode.imputed.tsv
[PRED] Kept markers : 2000

Reading training phenotypic data...
Reading test phenotypic data...

[STEP]Transpose marker file for a GS format...
Transposed training marker file: /isilon/projects/J-002035_flaxgenomics/CZ_project/github_OmniGS_R/finalFile/example/outputFile/intermediate_data/train_genotype.aligned.sorted.harmonized.vcf.GSCode.imputed.samples_x_markers.tsv
Imputed marker file: /isilon/projects/J-002035_flaxgenomics/CZ_project/github_OmniGS_R/finalFile/example/outputFile/intermediate_data/train_genotype.aligned.sorted.harmonized.vcf.GSCode.imputed.samples_x_markers.tsv
Transposed training marker file: /isilon/projects/J-002035_flaxgenomics/CZ_project/github_OmniGS_R/finalFile/example/outputFile/intermediate_data/test_genotype.harmonized.vcf.GSCode.imputed.samples_x_markers.tsv
Imputed marker file: /isilon/projects/J-002035_flaxgenomics/CZ_project/github_OmniGS_R/finalFile/example/outputFile/intermediate_data/test_genotype.harmonized.vcf.GSCode.imputed.samples_x_markers.tsv

Performing prediction... 
Mode: Prediction
Models: [RR-BLUP, GBLUP, BRR, BL, BayesA, BayesB, BayesC, RFR, SVR, RKHS, RFC, SVC]
Trait: YLD

Post analysis of GS results...
Wrote R plotting script to: /isilon/projects/J-002035_flaxgenomics/CZ_project/github_OmniGS_R/finalFile/example/outputFile/trait_predictions/plot_pred_obs.R
Loaded phenotype file: traits=[YLD]
Loaded prediction: trait=YLD model=BayesA rows=186
Loaded prediction: trait=YLD model=SVR rows=186
Loaded prediction: trait=YLD model=BL rows=186
Loaded prediction: trait=YLD model=BayesC rows=186
Loaded prediction: trait=YLD model=RR-BLUP rows=186
Loaded prediction: trait=YLD model=BayesB rows=186
Loaded prediction: trait=YLD model=GBLUP rows=186
Loaded prediction: trait=YLD model=RFC rows=186
Loaded prediction: trait=YLD model=RKHS rows=186
Loaded prediction: trait=YLD model=SVC rows=186
Loaded prediction: trait=YLD model=BRR rows=186
Loaded prediction: trait=YLD model=RFR rows=186
Wrote merged: /isilon/projects/J-002035_flaxgenomics/CZ_project/github_OmniGS_R/finalFile/example/outputFile/trait_predictions/YLD_merged_predictions.txt
Plot created by R: /isilon/projects/J-002035_flaxgenomics/CZ_project/github_OmniGS_R/finalFile/example/outputFile/plots/YLD_SVC_scatter.png
Plot created by R: /isilon/projects/J-002035_flaxgenomics/CZ_project/github_OmniGS_R/finalFile/example/outputFile/plots/YLD_RKHS_scatter.png
Plot created by R: /isilon/projects/J-002035_flaxgenomics/CZ_project/github_OmniGS_R/finalFile/example/outputFile/plots/YLD_BRR_scatter.png
Plot created by R: /isilon/projects/J-002035_flaxgenomics/CZ_project/github_OmniGS_R/finalFile/example/outputFile/plots/YLD_BayesC_scatter.png
Plot created by R: /isilon/projects/J-002035_flaxgenomics/CZ_project/github_OmniGS_R/finalFile/example/outputFile/plots/YLD_BayesB_scatter.png
Plot created by R: /isilon/projects/J-002035_flaxgenomics/CZ_project/github_OmniGS_R/finalFile/example/outputFile/plots/YLD_BayesA_scatter.png
Plot created by R: /isilon/projects/J-002035_flaxgenomics/CZ_project/github_OmniGS_R/finalFile/example/outputFile/plots/YLD_RR-BLUP_scatter.png
Plot created by R: /isilon/projects/J-002035_flaxgenomics/CZ_project/github_OmniGS_R/finalFile/example/outputFile/plots/YLD_BL_scatter.png
Plot created by R: /isilon/projects/J-002035_flaxgenomics/CZ_project/github_OmniGS_R/finalFile/example/outputFile/plots/YLD_GBLUP_scatter.png
Plot created by R: /isilon/projects/J-002035_flaxgenomics/CZ_project/github_OmniGS_R/finalFile/example/outputFile/plots/YLD_SVR_scatter.png
Plot created by R: /isilon/projects/J-002035_flaxgenomics/CZ_project/github_OmniGS_R/finalFile/example/outputFile/plots/YLD_RFC_scatter.png
Plot created by R: /isilon/projects/J-002035_flaxgenomics/CZ_project/github_OmniGS_R/finalFile/example/outputFile/plots/YLD_RFR_scatter.png
Updated summary: outputFile/prediction_detailed_results.txt

=== Final prediction summary === 
YLD:
  RR-BLUP: Train model R2 = 0.941 PearsonR  = 0.732
  GBLUP: Train model R2 = 0.935 PearsonR  = 0.736
  BRR: Train model R2 = 0.937 PearsonR  = 0.722
  BayesianLasso: Train model R2 = 0.930 PearsonR  = 0.731
  BayesA: Train model R2 = 0.933 PearsonR  = 0.727
  BayesB: Train model R2 = 0.936 PearsonR  = 0.720
  BayesC: Train model R2 = 0.934 PearsonR  = 0.724
  RFR: Train model R2 = 0.970 PearsonR  = 0.680
  SVR: Train model R2 = 0.972 PearsonR  = 0.685
  RKHS: Train model R2 = 0.960 PearsonR  = 0.753
  RFC: Train model R2 = 0.725 PearsonR  = 0.688
  SVC: Train model R2 = 0.682 PearsonR  = 0.517



Pipeline finished. Elapsed: 4.25 mins
