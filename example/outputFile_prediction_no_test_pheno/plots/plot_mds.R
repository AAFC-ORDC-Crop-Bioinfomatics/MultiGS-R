args <- commandArgs(trailingOnly=TRUE)
if(length(args) < 3) stop('Usage: Rscript plot_mds.R coords.tsv out.png "Title" [width height]')
infile <- args[1]; outfile <- args[2]; title <- args[3]
width <- ifelse(length(args) >= 4, as.integer(args[4]), 800)
height <- ifelse(length(args) >= 5, as.integer(args[5]), 600)
dat <- try(read.table(infile, header=TRUE, sep='\t', stringsAsFactors=FALSE), silent=TRUE)
if(inherits(dat,'try-error')) stop('Cannot read coords TSV: ')
if(!all(c('sample','x','y','group') %in% colnames(dat))) stop('Coords TSV must contain sample,x,y,group')
dat$group <- as.factor(dat$group)
cols <- c('train'='blue','test'='red')
png(filename=outfile, width=width, height=height)
par(mar=c(5,4,4,2)+0.1)
plot(dat$x, dat$y, pch=19, col=cols[as.character(dat$group)], xlab='MDS1', ylab='MDS2', main=title)
legend('topright', legend=levels(dat$group), col=cols[levels(dat$group)], pch=19, bty='n')
text(dat$x, dat$y, labels=ifelse(nrow(dat) <= 80, as.character(dat$sample), ''), pos=4, cex=0.6)
dev.off()
